<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–í–∞—à–∞ –∑–∞—è–≤–∫–∞ - –°—Ç—Ä–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <style>
      .messages {
        margin-bottom: 20px;
      }

      .messages .message {
        padding: 10px 15px;
        margin-bottom: 10px;
        border-radius: 4px;
      }

      .messages .success {
        background-color: #d4edda;
        color: #155724;
      }

      .messages .error {
        background-color: #f8d7da;
        color: #721c24;
      }
      
      .action-links {
        text-align: center;
        margin-top: 20px;
        margin-bottom: 20px;
      }
      
      .action-links a, .action-links button {
        margin: 0 10px;
        display: inline-block;
      }
    </style>
  </head>
  <body>
    <header>
      <div class="container">
        <div class="home-link">
          <a href="{% url 'index' %}">üè† –î–æ–º–æ–π</a>
        </div>
        <div class="logo">–°—Ç—Ä–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å</div>
        <div class="header-right">
          {% if user.is_authenticated %}
          <span>{{ user.username }}</span>
          {% endif %}
        </div>
      </div>
    </header>

    <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
    {% if messages %}
    <div class="container">
      <div class="messages">
        {% for message in messages %}
        <div class="message {{ message.tags }}">{{ message }}</div>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <section>
      <div class="container">
        <p>
          <a href="{% url 'index' %}" class="hero-back-link">–ù–∞–∑–∞–¥ –∫ –æ–±—ä–µ–∫—Ç–∞–º</a>
        </p>
      </div>
    </section>

    <div class="container mt-4">
      <div class="row">
        <div class="col-12">
          <h1 class="mb-4">–í–∞—à–∞ —Ç–µ–∫—É—â–∞—è –∑–∞—è–≤–∫–∞ –Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –Ω–∞–¥–∑–æ—Ä</h1>
            
          {% if request_items %}
            <div class="card shadow mb-4">
              <div class="card-header bg-primary text-white">
                <h5 class="mb-0">–ó–∞—è–≤–∫–∞ #{{ technical_supervision.id }}</h5>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-bordered">
                    <thead>
                      <tr>
                        <th>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</th>
                        <th>–û–±—ä–µ–∫—Ç</th>
                        <th>–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</th>
                        <th>–ü–ª–æ—â–∞–¥—å</th>
                        <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                        <th>–ü–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for item in request_items %}
                      <tr>
                        <td style="width: 80px;">
                          <img src="{{ item.building_object.image_url|default:'/static/images/building1.jpg' }}" 
                               alt="{{ item.building_object.name }}" 
                               style="width: 70px; height: 50px; object-fit: cover;">
                        </td>
                        <td>
                          <a href="{% url 'service_detail' item.building_object.id %}">
                            {{ item.building_object.name }}
                          </a>
                        </td>
                        <td>{{ item.building_object.location }}</td>
                        <td>{{ item.building_object.area }} –º¬≤</td>
                        <td>{{ item.quantity }}</td>
                        <td>{{ item.order_number }}</td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
                
            <div class="action-links">
              <!-- –°—Å—ã–ª–∫–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π –∑–∞—è–≤–∫–∏ -->
              <a href="{% url 'build_request_detail' technical_supervision.id %}" class="hero-back-link">
                –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Ç–∞–ª–∏ –∑–∞—è–≤–∫–∏
              </a>
              
              <!-- –§–æ—Ä–º–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞—è–≤–∫–∏ —Å –∫–Ω–æ–ø–∫–æ–π –≤ –≤–∏–¥–µ —Å—Å—ã–ª–∫–∏ -->
              <form method="post" action="{% url 'delete_request' technical_supervision.id %}" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="hero-back-link" style="background: none; border: none; cursor: pointer; color: #007bff; text-decoration: underline;">
                  –£–¥–∞–ª–∏—Ç—å –∑–∞—è–≤–∫—É
                </button>
              </form>
            </div>
          {% else %}
            <div class="alert alert-info">
              <p>–í –≤–∞—à–µ–π –∑–∞—è–≤–∫–µ –Ω–µ—Ç —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.</p>
              <a href="{% url 'index' %}" class="hero-back-link">–ü–µ—Ä–µ–π—Ç–∏ –∫ –≤—ã–±–æ—Ä—É –æ–±—ä–µ–∫—Ç–æ–≤</a>
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <footer>
      <p>¬© 2025 –°—Ç—Ä–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    </footer>
  </body>
</html>