<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–∏ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞—è–≤–∫–∏ - –°—Ç—Ä–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
</head>
<body>
    <header>
      <div class="container">
        <div class="home-link">
          <a href="{% url 'index' %}">üè† –î–æ–º–æ–π</a>
        </div>
        <div class="logo">–°—Ç—Ä–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å</div>
        <div class="header-right"></div>
      </div>
    </header>

    <!-- –ü–æ–¥—Ö–µ–¥–µ—Ä —Å –∫–æ—Ä–∑–∏–Ω–æ–π -->
    <div class="subheader">
      <div class="container">
        <div class="cart-container">
          <a href="{% url 'build_request_detail' order_id=1 %}">
            <div class="cart">
              üõí
              <span class="cart-badge">1</span>
            </div>
          </a>
        </div>
      </div>
    </div>

    <section>
        <div class="container">
            <h1>–ú–æ—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—è–≤–∫–∞</h1>
        </div>
    </section>
    
    <main>
        <div class="container">
            <div class="orders-container">
                <div id="order-items-container" class="order-items">
                    <!-- –°—é–¥–∞ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—è–≤–∫–∏ —á–µ—Ä–µ–∑ JavaScript -->
                </div>
                
                <div class="order-summary">
                    <span>–í—Å–µ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤:</span>
                    <span id="total-count" class="total-count">0</span>
                </div>
                
                <div class="order-actions">
                    <button onclick="saveOrder()" class="primary-button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—É—é –∑–∞—è–≤–∫—É</button>
                    <a href="{% url 'index' %}" class="secondary-link">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –æ–±—ä–µ–∫—Ç–∞–º</a>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p>¬© 2025 –°—Ç—Ä–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    </footer>

<script>
// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—è–≤–∫–∏ –∏–∑ sessionStorage
document.addEventListener('DOMContentLoaded', function() {
    const orderData = JSON.parse(sessionStorage.getItem('orderData') || '[]');
    displayOrderItems(orderData);
});

function displayOrderItems(orderData) {
    const container = document.getElementById('order-items-container');
    const totalCount = document.getElementById('total-count');
    
    if (orderData.length === 0) {
        container.innerHTML = '<div class="empty-order">–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—è–≤–∫–∞ –ø—É—Å—Ç–∞</div>';
        totalCount.textContent = '0';
        return;
    }
    
    let html = '';
    orderData.forEach((item, index) => {
        html += `
            <div class="order-item">
                <div class="order-item-header">
                    <strong>${item.serviceTitle}</strong>
                    <span>${item.date}</span>
                </div>
                <div class="order-item-label">–†–µ–∑—É–ª—å—Ç–∞—Ç:</div>
                <div class="order-item-result">${item.result}</div>
            </div>
        `;
    });
    
    container.innerHTML = html;
    totalCount.textContent = orderData.length;
}

function saveOrder() {
    const orderData = JSON.parse(sessionStorage.getItem('orderData') || '[]');
    if (orderData.length === 0) {
        alert('–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—è–≤–∫–∞ –ø—É—Å—Ç–∞!');
        return;
    }
    
    // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞—è–≤–∫–∏ (–¥–ª—è 3-–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π)
    alert(`–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—è–≤–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞! –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤: ${orderData.length}`);
    sessionStorage.removeItem('orderData');
    window.location.href = "{% url 'index' %}";
}
</script>
</body>
</html>